var c=Object.defineProperty;var a=(n,e,s)=>e in n?c(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s;var o=(n,e,s)=>a(n,typeof e!="symbol"?e+"":e,s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(t){if(t.ep)return;t.ep=!0;const i=s(t);fetch(t.href,i)}})();class d{constructor(){o(this,"sessionInput");o(this,"fileSelect");o(this,"contentDisplay");o(this,"currentSessionId","");o(this,"currentETag","");o(this,"refreshInterval",null);this.setupUI(),this.setupEventListeners();const e=localStorage.getItem("lastSessionId");e&&(this.sessionInput.value=e,this.loadFiles())}setupUI(){const e=document.querySelector("#app");e.innerHTML=`
      <div class="title-bar">
        <div class="controls">
          <input type="text" id="session-id" placeholder="Enter session ID" />
          <button id="load-files">Load Files</button>
          <select id="file-select"></select>
          <button id="refresh-file">Refresh File</button>
        </div>
      </div>
      <div class="content-area">
        <pre id="content-display"><code class="language-typescript"></code></pre>
      </div>
    `,this.sessionInput=document.querySelector("#session-id"),this.fileSelect=document.querySelector("#file-select"),this.contentDisplay=document.querySelector("#content-display")}setupEventListeners(){document.querySelector("#load-files").addEventListener("click",()=>this.loadFiles()),document.querySelector("#refresh-file").addEventListener("click",()=>this.loadSelectedFile()),this.fileSelect.addEventListener("change",()=>{this.loadSelectedFile(),this.setupAutoRefresh()})}setupAutoRefresh(){this.refreshInterval&&clearInterval(this.refreshInterval),this.refreshInterval=setInterval(()=>{this.loadSelectedFile()},3e4)}async loadFiles(){if(this.currentSessionId=this.sessionInput.value.trim(),!this.currentSessionId)return;this.currentETag="",this.refreshInterval&&clearInterval(this.refreshInterval);const e=this.fileSelect.value;try{const r=await(await fetch(`sessions/${this.currentSessionId}`)).json();localStorage.setItem("lastSessionId",this.currentSessionId),this.fileSelect.innerHTML=r.files.map(t=>`<option value="${t}">${t}</option>`).join(""),r.files.length>0&&(e&&r.files.includes(e)&&(this.fileSelect.value=e),this.loadSelectedFile(),this.setupAutoRefresh())}catch(s){console.error("Error loading files:",s),this.contentDisplay.textContent="Error loading files"}}async loadSelectedFile(){const e=this.fileSelect.value;if(!(!e||!this.currentSessionId))try{const s={};this.currentETag&&(s["If-None-Match"]=this.currentETag);const r=await fetch(`sessions/${this.currentSessionId}/file?file=${encodeURIComponent(e)}`,{headers:s});if(r.status===304)return;const t=r.headers.get("ETag");t&&(this.currentETag=t);const i=await r.json(),l=this.contentDisplay.querySelector("code");l.textContent=i.content,l.removeAttribute("data-highlighted"),hljs.highlightAll(),hljs.initLineNumbersOnLoad()}catch(s){console.error("Error loading file content:",s),this.contentDisplay.textContent="Error loading file content"}}}new d;
